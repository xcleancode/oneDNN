<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>oneDNN: Eltwise</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script src="assets/mathjax/MathJax.js?config=TeX-AMS_CHTML,dnnl"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="assets/customdoxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="assets/dnn.js"></script>
</head>
<body>
<div class="mobile-nav"><i id="nav-btn"></i><a href="index.html">oneAPI Deep Neural Network Library (oneDNN)</a></div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname">
     <a href="index.html">
      <div id="full-name">oneAPI Deep Neural Network Library (oneDNN)</div>
    </a>
   </div>
   <div id="projectbrief">Performance library for Deep Learning</div>
   <div id="projectnumber">1.95.1</div>
  <div>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dev_guide_eltwise.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Eltwise </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><blockquote class="doxtable">
<p></p>
<p><a class="el" href="group__dnnl__api__eltwise.html">API Reference</a></p>
<p></p>
</blockquote>
<h2>General</h2>
<h3>Forward</h3>
<p>The eltwise primitive applies an operation to every element of the tensor (the variable names follow the standard <a class="el" href="dev_guide_conventions.html">Naming Conventions</a>):</p>
<p class="formulaDsp">
\[ \dst(\overline{s}) = Operation(\src(\overline{s})), \]
</p>
<p>where \(\overline{s} = (s_n, .., s_0)\).</p>
<p>The following operations are supported:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Operation  </th><th class="markdownTableHeadLeft">oneDNN algorithm kind  </th><th class="markdownTableHeadLeft">Forward formula  </th><th class="markdownTableHeadLeft">Backward formula (from src)  </th><th class="markdownTableHeadLeft">Backward formula (from dst)   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">abs  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a2ac04aed39c46f6d6356744d9d12df43" title="Eltwise: abs. ">dnnl_eltwise_abs</a>  </td><td class="markdownTableBodyLeft">\( d = \begin{cases} s &amp; \text{if}\ s &gt; 0 \\ -s &amp; \text{if}\ s \leq 0 \end{cases} \)  </td><td class="markdownTableBodyLeft">\( ds = \begin{cases} dd &amp; \text{if}\ s &gt; 0 \\ -dd &amp; \text{if}\ s &lt; 0 \\ 0 &amp; \text{if}\ s = 0 \end{cases} \)  </td><td class="markdownTableBodyLeft">&ndash;   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">bounded_relu  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23aed5e7f85cc5d7dfeacefe6a7a5032502" title="Eltwise: bounded_relu. ">dnnl_eltwise_bounded_relu</a>  </td><td class="markdownTableBodyLeft">\( d = \begin{cases} \alpha &amp; \text{if}\ s &gt; \alpha \geq 0 \\ s &amp; \text{if}\ 0 &lt; s \leq \alpha \\ 0 &amp; \text{if}\ s \leq 0 \end{cases} \)  </td><td class="markdownTableBodyLeft">\( ds = \begin{cases} dd &amp; \text{if}\ 0 &lt; s \leq \alpha, \\ 0 &amp; \text{otherwise}\ \end{cases} \)  </td><td class="markdownTableBodyLeft">&ndash;   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">clip  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a026ef822b5cc28653e0730f8c8c2cf32" title="Eltwise: clip. ">dnnl_eltwise_clip</a>  </td><td class="markdownTableBodyLeft">\( d = \begin{cases} \beta &amp; \text{if}\ s &gt; \beta \geq \alpha \\ s &amp; \text{if}\ \alpha &lt; s \leq \beta \\ \alpha &amp; \text{if}\ s \leq \alpha \end{cases} \)  </td><td class="markdownTableBodyLeft">\( ds = \begin{cases} dd &amp; \text{if}\ \alpha &lt; s \leq \beta \\ 0 &amp; \text{otherwise}\ \end{cases} \)  </td><td class="markdownTableBodyLeft">&ndash;   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">elu  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a7afda2aa9bac4a229909522235f461b5" title="Eltwise: exponential linear unit (elu) ">dnnl_eltwise_elu</a> <br />
 <a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a975aea11dce8571bf1d4b2552c652a27" title="Eltwise: exponential linear unit (elu) (dst for backward) ">dnnl_eltwise_elu_use_dst_for_bwd</a>  </td><td class="markdownTableBodyLeft">\( d = \begin{cases} s &amp; \text{if}\ s &gt; 0 \\ \alpha (e^s - 1) &amp; \text{if}\ s \leq 0 \end{cases} \)  </td><td class="markdownTableBodyLeft">\( ds = \begin{cases} dd &amp; \text{if}\ s &gt; 0 \\ dd \cdot \alpha e^s &amp; \text{if}\ s \leq 0 \end{cases} \)  </td><td class="markdownTableBodyLeft">\( ds = \begin{cases} dd &amp; \text{if}\ d &gt; 0 \\ dd \cdot (d + \alpha) &amp; \text{if}\ d \leq 0 \end{cases}. See\ (2). \)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">exp  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a4859f1326783a273500ef294bb7c7d5c" title="Eltwise: exponent. ">dnnl_eltwise_exp</a> <br />
 <a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23ae7f15ca067ce527eb66a35767d253e81" title="Eltwise: exp (dst for backward) ">dnnl_eltwise_exp_use_dst_for_bwd</a>  </td><td class="markdownTableBodyLeft">\( d = e^s \)  </td><td class="markdownTableBodyLeft">\( ds = dd \cdot e^s \)  </td><td class="markdownTableBodyLeft">\( ds = dd \cdot d \)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">gelu_erf  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a676e7d4e899ab2bbddc72f73a54c7779" title="Eltwise: erf-based gelu. ">dnnl_eltwise_gelu_erf</a>  </td><td class="markdownTableBodyLeft">\( d = 0.5 s (1 + \mathop{erf}[\frac{s}{\sqrt{2}}])\)  </td><td class="markdownTableBodyLeft">\( ds = dd \cdot \left(0.5 + 0.5 \, \mathop{erf}\left({\frac{s}{\sqrt{2}}}\right) + \frac{s}{\sqrt{2\pi}}e^{-0.5s^{2}}\right) \)  </td><td class="markdownTableBodyLeft">&ndash;   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">gelu_tanh  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a18c14d6904040bff94bce8a43c039c62" title="Eltwise: gelu. ">dnnl_eltwise_gelu_tanh</a>  </td><td class="markdownTableBodyLeft">\( d = 0.5 s (1 + \tanh[\sqrt{\frac{2}{\pi}} (s + 0.044715 s^3)])\)  </td><td class="markdownTableBodyLeft">\( See\ (1). \)  </td><td class="markdownTableBodyLeft">&ndash;   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">linear  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23aed5eec69000ddfe6ac96e161b0d723b4" title="Eltwise: linear. ">dnnl_eltwise_linear</a>  </td><td class="markdownTableBodyLeft">\( d = \alpha s + \beta \)  </td><td class="markdownTableBodyLeft">\( ds = \alpha \cdot dd \)  </td><td class="markdownTableBodyLeft">&ndash;   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">log  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a8ea10785816fd41353b49445852e0b74" title="Eltwise: natural logarithm. ">dnnl_eltwise_log</a>  </td><td class="markdownTableBodyLeft">\( d = \log_{e}{s} \)  </td><td class="markdownTableBodyLeft">\( ds = \frac{dd}{s} \)  </td><td class="markdownTableBodyLeft">&ndash;   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">logistic  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23ab560981bee9e7711017423e29ba46071" title="Eltwise: logistic. ">dnnl_eltwise_logistic</a> <br />
 <a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23ad224a5a4730407c8b97a10fb53d1fe0f" title="Eltwise: logistic (dst for backward) ">dnnl_eltwise_logistic_use_dst_for_bwd</a>  </td><td class="markdownTableBodyLeft">\( d = \frac{1}{1+e^{-s}} \)  </td><td class="markdownTableBodyLeft">\( ds = \frac{dd}{1+e^{-s}} \cdot (1 - \frac{1}{1+e^{-s}}) \)  </td><td class="markdownTableBodyLeft">\( ds = dd \cdot d \cdot (1 - d) \)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">pow  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23aa1d0f7a69b7dfbfbd817623552558054" title="Eltwise: pow. ">dnnl_eltwise_pow</a>  </td><td class="markdownTableBodyLeft">\( d = \alpha s^{\beta} \)  </td><td class="markdownTableBodyLeft">\( ds = dd \cdot \alpha \beta s^{\beta - 1} \)  </td><td class="markdownTableBodyLeft">&ndash;   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">relu  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a5e37643fec6531331e2e38df68d4c65a" title="Eltwise: ReLU. ">dnnl_eltwise_relu</a> <br />
 <a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23aa2fffcdde8480cd08a0d6e4dee7dec53" title="Eltwise: ReLU (dst for backward) ">dnnl_eltwise_relu_use_dst_for_bwd</a>  </td><td class="markdownTableBodyLeft">\( d = \begin{cases} s &amp; \text{if}\ s &gt; 0 \\ \alpha s &amp; \text{if}\ s \leq 0 \end{cases} \)  </td><td class="markdownTableBodyLeft">\( ds = \begin{cases} dd &amp; \text{if}\ s &gt; 0 \\ \alpha \cdot dd &amp; \text{if}\ s \leq 0 \end{cases} \)  </td><td class="markdownTableBodyLeft">\( ds = \begin{cases} dd &amp; \text{if}\ d &gt; 0 \\ \alpha \cdot dd &amp; \text{if}\ d \leq 0 \end{cases}. See\ (2). \)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">round  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23adda28cb0389d39c0c43967352b116d9d" title="Eltwise: round. ">dnnl_eltwise_round</a>  </td><td class="markdownTableBodyLeft">\( d = round(s) \)  </td><td class="markdownTableBodyLeft">&ndash;  </td><td class="markdownTableBodyLeft">&ndash;   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">soft_relu  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a82d95f7071af086d4b1652160d9a972f" title="Eltwise: soft_relu. ">dnnl_eltwise_soft_relu</a>  </td><td class="markdownTableBodyLeft">\( d = \log_{e}(1+e^s) \)  </td><td class="markdownTableBodyLeft">\( ds = \frac{dd}{1 + e^{-s}} \)  </td><td class="markdownTableBodyLeft">&ndash;   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">sqrt  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a2152d4664761b356bbceed3d9afe2189" title="Eltwise: square root. ">dnnl_eltwise_sqrt</a> <br />
 <a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a45b82064ee41f69c5463895c41ec24d0" title="Eltwise: square root (dst for backward) ">dnnl_eltwise_sqrt_use_dst_for_bwd</a>  </td><td class="markdownTableBodyLeft">\( d = \sqrt{s} \)  </td><td class="markdownTableBodyLeft">\( ds = \frac{dd}{2\sqrt{s}} \)  </td><td class="markdownTableBodyLeft">\( ds = \frac{dd}{2d} \)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">square  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a4da34cea03ccb7cc2701b2f2023bcc2e" title="Eltwise: square. ">dnnl_eltwise_square</a>  </td><td class="markdownTableBodyLeft">\( d = s^2 \)  </td><td class="markdownTableBodyLeft">\( ds = dd \cdot 2 s \)  </td><td class="markdownTableBodyLeft">&ndash;   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">swish  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a63447dedf2e45ab535f1365502ff3240" title="Eltwise: swish. ">dnnl_eltwise_swish</a>  </td><td class="markdownTableBodyLeft">\( d = \frac{s}{1+e^{-\alpha s}} \)  </td><td class="markdownTableBodyLeft">\( ds = \frac{dd}{1 + e^{-\alpha s}}(1 + \alpha s (1 - \frac{1}{1 + e^{-\alpha s}})) \)  </td><td class="markdownTableBodyLeft">&ndash;   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">tanh  </td><td class="markdownTableBodyLeft"><a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a81b20d8f0b54c7114024186a9fbb698e" title="Eltwise: hyperbolic tangent non-linearity (tanh) ">dnnl_eltwise_tanh</a> <br />
 <a class="el" href="group__dnnl__api__primitives__common.html#gga96946c805f6c4922c38c37049ab95d23a04e559b66a5d43a74a9f1b91da78151c" title="Eltwise: hyperbolic tangent non-linearity (tanh) (dst for backward) ">dnnl_eltwise_tanh_use_dst_for_bwd</a>  </td><td class="markdownTableBodyLeft">\( d = \tanh{s} \)  </td><td class="markdownTableBodyLeft">\( ds = dd \cdot (1 - \tanh^2{s}) \)  </td><td class="markdownTableBodyLeft">\( ds = dd \cdot (1 - d^2) \)   </td></tr>
</table>
<p>\( (1)\ ds = dd \cdot 0.5 (1 + tanh[\sqrt{\frac{2}{\pi}} (s + 0.044715 s^3)]) \cdot (1 + \sqrt{\frac{2}{\pi}} (s + 0.134145 s^3) \cdot (1 - tanh[\sqrt{\frac{2}{\pi}} (s + 0.044715 s^3)]) ) \)</p>
<p>\( (2)\ \text{Operation is supported only for } \alpha \geq 0. \)</p>
<h4>Difference Between Forward Training and Forward Inference</h4>
<p>There is no difference between the <a class="el" href="group__dnnl__api__primitives__common.html#ggae3c1f22ae55645782923fbfd8b07d0c4a992e03bebfe623ac876b3636333bbce0" title="Forward data propagation (training mode). ">dnnl_forward_training</a> and <a class="el" href="group__dnnl__api__primitives__common.html#ggae3c1f22ae55645782923fbfd8b07d0c4a2f77a568a675dec649eb0450c997856d" title="Forward data propagation (inference mode). ">dnnl_forward_inference</a> propagation kinds.</p>
<h3>Backward</h3>
<p>The backward propagation computes \(\diffsrc(\overline{s})\), based on \(\diffdst(\overline{s})\) and \(\src(\overline{s})\). However, some operations support a computation using \(\dst(\overline{s})\) memory produced during forward propagation. Refer to the table above for a list of operations supporting destination as input memory and the corresponding formulas.</p>
<h4>Exceptions</h4>
<p>The eltwise primitive with algorithm round does not support backward propagation.</p>
<h2>Execution Arguments</h2>
<p>When executed, the inputs and outputs should be mapped to an execution argument index as specified by the following table.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Primitive input/output  </th><th class="markdownTableHeadNone">Execution argument index   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">\(\src\)  </td><td class="markdownTableBodyNone">DNNL_ARG_SRC   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">\(\dst\)  </td><td class="markdownTableBodyNone">DNNL_ARG_DST   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">\(\diffsrc\)  </td><td class="markdownTableBodyNone">DNNL_ARG_DIFF_SRC   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">\(\diffdst\)  </td><td class="markdownTableBodyNone">DNNL_ARG_DIFF_DST   </td></tr>
</table>
<h2>Implementation Details</h2>
<h3>General Notes</h3>
<ol type="1">
<li>All eltwise primitives have a common initialization function (e.g., <a class="el" href="structdnnl_1_1eltwise__forward_1_1desc.html#aaae0eddf378516c155c2946e15972d98" title="Constructs a descriptor for an elementwise forward propagation primitive. ">dnnl::eltwise_forward::desc::desc()</a>) which takes both parameters \(\alpha\), and \(\beta\). These parameters are ignored if they are unused.</li>
<li>The memory format and data type for \(\src\) and \(\dst\) are assumed to be the same, and in the API are typically referred as <code>data</code> (e.g., see <code>data_desc</code> in <a class="el" href="structdnnl_1_1eltwise__forward_1_1desc.html#aaae0eddf378516c155c2946e15972d98" title="Constructs a descriptor for an elementwise forward propagation primitive. ">dnnl::eltwise_forward::desc::desc()</a>). The same holds for \(\diffsrc\) and \(\diffdst\). The corresponding memory descriptors are referred to as <code>diff_data_desc</code>.</li>
<li>Both forward and backward propagation support in-place operations, meaning that \(\src\) can be used as input and output for forward propagation, and \(\diffdst\) can be used as input and output for backward propagation. In case of an in-place operation, the original data will be overwritten. Note, however, that some algorithms for backward propagation require original \(\src\), hence the corresponding forward propagation should not be performed in-place for those algorithms. Algorithms that use \(\dst\) for backward propagation can be safely done in-place.</li>
<li>For some operations it might be beneficial to compute backward propagation based on \(\dst(\overline{s})\), rather than on \(\src(\overline{s})\), for improved performance.</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>For operations supporting destination memory as input, \(\dst\) can be used instead of \(\src\) when backward propagation is computed. This enables several performance optimizations (see the tips below).</dd></dl>
<h3>Data Type Support</h3>
<p>The eltwise primitive supports the following combinations of data types:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Propagation  </th><th class="markdownTableHeadLeft">Source / Destination  </th><th class="markdownTableHeadLeft">Int   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">forward / backward  </td><td class="markdownTableBodyLeft">f32, bf16  </td><td class="markdownTableBodyLeft">f32   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">forward  </td><td class="markdownTableBodyLeft">f16  </td><td class="markdownTableBodyLeft">f16   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">forward  </td><td class="markdownTableBodyLeft">s32 / s8 / u8  </td><td class="markdownTableBodyLeft">f32   </td></tr>
</table>
<dl class="section warning"><dt>Warning</dt><dd>There might be hardware and/or implementation specific restrictions. Check <a class="el" href="dev_guide_eltwise.html#dg_eltwise_impl_limits">Implementation Limitations</a> section below.</dd></dl>
<p>Here the intermediate data type means that the values coming in are first converted to the intermediate data type, then the operation is applied, and finally the result is converted to the output data type.</p>
<h3>Data Representation</h3>
<p>The eltwise primitive works with arbitrary data tensors. There is no special meaning associated with any logical dimensions.</p>
<h3>Post-ops and Attributes</h3>
<p>The eltwise primitive does not support any post-ops or attributes.</p>
<p><a class="anchor" id="dg_eltwise_impl_limits"></a></p><h2>Implementation Limitations</h2>
<ol type="1">
<li>Refer to <a class="el" href="dev_guide_data_types.html">Data Types</a> for limitations related to data types support.</li>
</ol>
<h2>Performance Tips</h2>
<ol type="1">
<li>For backward propagation, use the same memory format for \(\src\), \(\diffdst\), and \(\diffsrc\) (the format of the \(\diffdst\) and \(\diffsrc\) are always the same because of the API). Different formats are functionally supported but lead to highly suboptimal performance.</li>
<li>Use in-place operations whenever possible (see caveats in General Notes).</li>
<li>As mentioned above for all operations supporting destination memory as input, one can use the \(\dst\) tensor instead of \(\src\). This enables the following potential optimizations for training:<ul>
<li>Such operations can be safely done in-place.</li>
<li>Moreover, such operations can be fused as a <a class="el" href="dev_guide_attributes.html">post-op</a> with the previous operation if that operation does not require its \(\dst\) to compute the backward propagation (e.g., if the convolution operation satisfies these conditions).</li>
</ul>
</li>
</ol>
<h2>Examples</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Engine  </th><th class="markdownTableHeadLeft">Name  </th><th class="markdownTableHeadLeft">Com   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">CPU/GPU  </td><td class="markdownTableBodyLeft"><a class="el" href="eltwise_example_cpp.html">Element-Wise Primitive Example</a>  </td><td class="markdownTableBodyLeft">This C++ API example demonstrates how to create and execute an <a class="el" href="dev_guide_eltwise.html">Element-wise</a> primitive in forward training propagation mode.   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div class="footer">
    <script>
        $('#top').prependTo($('#side-nav'));
    </script>
    <div class="footer-wrapper">
        <hr>
        <ul class="footer-links">
            <li><a href="legal_information.html">Legal information</a></li>
        </ul>
    </div>
</div>